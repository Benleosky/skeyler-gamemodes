----------------------	Sassilization--	By Sassafrass / Spacetech / LuaPineapple--------------------local tex = Material("sassilization/goldhud.png")local texw, texh = 271, 90local tex2 = Material("sassilization/icons/gold.png")local texw2, texh2 = 32, 32local runnerUpGold, gold, u, v, w, h, x, y, x1, y1, textX, textY, textWidth, textHeightfunction GM:DrawGoldBar( le, sw, sh, scale )	local scale = scale*0.85	surface.SetMaterial(tex)		--Calculate Win Goal	SA.WIN_GOAL = SA.WIN_GOAL_MIN	runnerUpGold = false	runnerUpGoldEmp = nil	leaderGold = false	leaderGoldEmp = nil	for _, empire in pairs( empire.GetAll() ) do		if( empire ) then			gold = empire:GetGold()			if( not leaderGold or gold > leaderGold ) then				leaderGold = gold				leaderGoldEmp = empire			end		end	end	for _, empire in pairs( empire.GetAll() ) do		if( empire ) then			if( not runnerUpGold or (gold > runnerUpGold) ) then				if empire != leaderGoldEmp then					gold = empire:GetGold()					if !IsAllied(empire, leaderGoldEmp) then						runnerUpGold = gold						runnerUpGoldEmp = empire					end				end			end		end	end	if leaderGold > 600 then		if runnerUpGold then			if leaderGold - runnerUpGold < 200 then				if runnerUpGold + 200 > 1000 then					SA.WIN_GOAL = 1000				else					SA.WIN_GOAL = runnerUpGold + 200				end			end		end	end	SA.WIN_GOAL = math.Clamp( math.min( SA.WIN_GOAL, gold + SA.WIN_LEAD ), SA.WIN_GOAL_MIN, SA.WIN_LIMIT )		u, v = 0, 0	w, h = 264, 96	x, y = 1 * scale, sh - h * scale	--Draw background	surface.DrawTexturedRectUVEx( x, y, w * scale, h * scale, u, v, 1, 1 )		--Draw bar background	w, h = 204, 24	x1, y1 = x + 30 * scale, y + 25 * scale	surface.SetDrawColor( 83, 63, 5, 255 )	surface.DrawRect( x1, y1, w * scale, h * scale )	--Draw bar	u, v = 4 / texw - (RealTime() * 3) % 4 / texw, 112 / texh	w, h = 204 * math.Clamp( le:GetGold() / SA.WIN_GOAL, 0, 1 ), 24	x1, y1 = x + 30 * scale, y + 25 * scale	surface.SetMaterial(Material("sassilization/gold_bar.png"))	surface.SetDrawColor( 255, 255, 255, 255 )	surface.DrawTexturedRect( x1, y1, w * scale, h * scale )	--Draw Border	w, h = 204, 24	x1, y1 = x + 30 * scale, y + 25 * scale	surface.SetDrawColor( 0, 0, 0, 255 )	surface.DrawOutlinedRect( x1, y1, w * scale, h * scale )		--Draw Runner Up/Leader Marker	h = 24	if LocalEmpire() != leaderGoldEmp then		if( leaderGold ) then			x1 = x1 + 204 * math.Clamp( leaderGold / SA.WIN_GOAL, 0, 1 ) * scale			surface.SetDrawColor( 255, 0, 0, 100 )			surface.DrawRect( x1, y1, 2, (h+1) * scale )			surface.SetDrawColor( 200, 0, 0, 150 )			surface.DrawRect( x1 + 1, y1, 1, (h+1) * scale )			surface.SetDrawColor( 255, 255, 255, 255 )		end	else		if( runnerUpGold ) then			x1 = x1 + 204 * math.Clamp( runnerUpGold / SA.WIN_GOAL, 0, 1 ) * scale			surface.SetDrawColor( 255, 0, 0, 100 )			surface.DrawRect( x1, y1, 2, (h+1) * scale )			surface.SetDrawColor( 200, 0, 0, 150 )			surface.DrawRect( x1 + 1, y1, 1, (h+1) * scale )			surface.SetDrawColor( 255, 255, 255, 255 )		end	end		--Draw gold icon	surface.SetDrawColor( 255, 255, 255, 255 )	surface.SetMaterial(tex2)	u, v = 32/texw2, 32/texh2	w, h = 32, 32	x1, y1 = x + 32 * scale, y + 50 * scale	surface.DrawTexturedRectUVEx( x1, y1, w * scale, h * scale, 0, 0, u, v )	--Draw gold text	surface.SetFont( SA.HUD.FONTS.GoldBarFont )	surface.SetTextColor( 255, 255, 255, 255 )	surface.SetTextPos( x1 + 45 * scale, y1 + 4 * scale )		textX, textY = x1 + 45 * scale, y1 + 5 * scale	textWidth, textHeight = surface.GetTextSize( tostring( le:GetGold() ) .. " " )		surface.DrawText( tostring( le:GetGold() ) )	textX = textX + textWidth		surface.SetTextPos( textX, textY )	surface.SetTextColor( 100, 255, 100, 255 )	surface.DrawText( " (+" .. tostring( le:GetGoldIncome() ) .. ")" )		textWidth, textHeight = surface.GetTextSize( " (+" .. tostring( le:GetGoldIncome() ) .. ") " )	textX = textX + textWidth		surface.SetTextPos( textX, textY )	surface.SetTextColor( 200, 200, 200, 255 )	surface.DrawText( "/ " .. tostring( SA.WIN_GOAL ) )end